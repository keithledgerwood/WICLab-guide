# Identity Governance

Okta Identity Governance (OIG) is a unified IAM and governance solution that includes three products to help governance, risk and compliance teams simplify access fulfillment and entitlement tasks throughout the identity lifecycle:

- Okta Lifecycle Management
- Okta Workflows
- Okta Access Governance

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image2.png "image_tooltip")

Okta Lifecycle Management provides pre-built integrations between HR and IT systems, to automatically keep employee information and status in sync with the IT applications they use. As employees join, move, or leave the company, IT can automatically assign, upgrade, or revoke applications and access, to increase productivity, protect the organization from data loss, and eliminate orphaned accounts that increase the attack surface area.

Okta Workflows provides the extensibility and customization necessary to solve the complex identity governance requirements of your particular organization. Easily automate identity processes at scale, without writing a single line of code. Enable anyone at your company to create innovative solutions with Okta using if-this-then-that logic, Okta’s pre-built connector library, and the ability to connect to any publicly available API.

Okta Access Governance plays a central role in the solution, simplifying access management tasks so administrators can make sure the right people have access to the right resources when they need them. Access Governance includes three key features:

- Access Request simplifies and automates the process of requesting access to applications and resources. It meets users where they are by offering self-service capabilities tightly integrated with collaboration tools, delivering a streamlined, frictionless approach that automatically routes user requests to one or more reviewers for approval and auto-provisions the access.
- Access Certification campaigns offer a simple process for creating audit campaigns to periodically review user access to critical resources and approve or revoke access automatically. Those processes are important for making sure employees do not accumulate access, and only users who need a resource have access to it.
- Governance Reports help organizations meet audit and compliance requirements. Share a high-level overview of past certification campaigns, including their duration and the resources included—or add more detail, including the users involved and remediation status. Administrators can also provide an audit of who has access to what resources, who approved the access and how they got the access. Access governance data is stored for 3 years.

With these combined capabilities, OIG helps organizations improve their security posture, mitigate modern risks, and improve efficiency. Unlike traditional IGA products, which can require complex and custom integrations that are difficult to deploy and expensive to maintain, Okta’s unified approach brings together identity, access, and governance to holistically improve an organization’s security posture. For example, customers today can integrate Okta with existing HR systems and directories and manage who gets access to what resources. If Okta detects unusual activity, such as a high-risk login through Okta ThreatInsights or a lifecycle status change, you can trigger a certification campaign and immediately suspend access to a resource.


**New Content -Start**
-----

## Workshop description

In this section of the workshop, we will explore the following capabilities:
Access Requests. Once configured, it can be used to grant access.
Access Certifications for Running Access Review Campaigns
Workflows to trigger actions based on specific events like the Change of the job title of one of the employees
This document section will use a pre-built flow and two connections with the Okta tenant.
This document section will explore the unconfigured Access Requests, walk through standard configuration, and then create and run a simple approval flow.

### Workflows connections pre-work

For the workflows in the Okta Workflow Pack to work, you will first need to create a token to connect Okta APIs for that :

1. Open Okta Admin Console and browse to **Security** > **API**

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img1.png "image_tooltip")

2. Find the menu in the content pane and click **TOKENS**

3. Create a token by clicking **CREATE TOKEN**

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/image2.png "image_tooltip")

4. Copy the token value and store as it will be the only time that you will be able to view it

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img3.png "image_tooltip")


### Workflow Connections


Now, you must configure the following Okta connectors in your Okta Tenant that have Workflow enabled.

Different components within Okta have other API endpoints and connectors. In this section, we will build 2 separate connections, one to access the **Universal Directory** and the second to push the configurations to the **Identity Governance**.

#### Create an API Connection


1. Open Okta Workflows by navigating to Okta Admin Console > **Workflow** > **Workflows Console** . this will redirect you to a new page

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img4.png "image_tooltip")

2. On the Workflows Console page, Click **CONNECTIONS** in the top navigation pan 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img5.png "image_tooltip")

3. Create a new connection by clicking the **NEW CONNECTION** button and select **API Connector** as a connection type.

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img6.png "image_tooltip")

4. Enter **Okta API - Token-based Auth** as a connection name and **Custom** as the Auth Type

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img7.png "image_tooltip")


5.  Enter **Authorization** for the Header Name field and  **SSWS** + the token generated in the Okta Admin console into the Value field


#### Create an Okta Connection

1. Open Okta Admin Console and browse to **Applications** > **Applications** and search for **Okta Workflows OAuth**

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img9.png "image_tooltip")

2. in **Okta Workflows OAuth** navigate to the **Sign On** Tab

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img10.png "image_tooltip")

3. Copy and note down the **Client ID** and **Client secret** for later use in this secation.

4. Open Okta Workflows by navigating to Okta Admin Console > **Workflow** > **Workflows Console**. This will redirect you to a new page.

5. On the Workflows Console page, Click **CONNECTIONS** in the top navigation pan and create a 2nd connection by clicking the **new connection** button 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img8.png "image_tooltip")

6. Entre **Okta** in the search bar, and choose **Okta** from the results

7. Enter the **Domain** of your Okta tenant

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img11.png "image_tooltip")

 > The domain should be provided without **https://** or **-admin**.for example, if you copy the following domain from the URL bar 'https://atko-admin.okta.com', then you should entre 'atko.okta.com' as the domain.

8. Paste the **Client ID** and **Client secret** from step 3.

9. Click on **Create**

The two connections have been created, and the Okta Workflow is ready to import.

##  Configuring the Flow

### Importing the flow

1. Download the lab flow “titleChanged.flow”

2. On the Workflows Console page, Click **Flows** in the top navigation pan

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img12.png "image_tooltip")

3. Create a new folder by clicking the **+** icon and name folder “Title Change”

4. Click on the **...** next to the newly created folder and select import 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img13.png "image_tooltip")

5. Select or Drag&Drop the downloaded flow pack

You have successfully imported the Flow.  

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img14.png "image_tooltip")


### Modify the imported Flow

There are a few modifications needed within the Workflow.

1. Click on the workflow to update the existing cards

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img15.png "image_tooltip")

2. Update the first **Compose** card to contain your specific okta tenant name.

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img16.png "image_tooltip")

3. Click **Save**

    > When saving the first time, you might see the below pop-up. Ensure the **Save all data that passes through the Flow?** box is checked, and click Save. 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img17.png "image_tooltip")


4. Click the **Flow is Off** button and click the Flow is Off to turn on the flow

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img18.png "image_tooltip")

You now have the Flow correctly configured and running.

### Stage a user to trigger the workflow

In order to trigger this flow, an action we're listening to should occur. In this case, an existing user that has a manager will have their title updated.

1. Assigne the user a manager, navigate to **Directory** > **People** > and select your test user. 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img19.png "image_tooltip")

2. Click on **Profile** then **Edit** and Scroll all the way down to find the **managerID** field, and update that with your email

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img20.png "image_tooltip")

3. In a Saparate page navigate to your **BambooHR** instance, Find the user and add a new **Job Entry**. 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img21.png "image_tooltip")


4. Back in the Okta administration UI, navigate to **Applications > Applications**, and select the BambooHR app definition.

5. In the **Import tab**, click **Import Now**, you should see that 1 user was updated 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img22.png "image_tooltip")

6. Confirm changes to your user by selecting them and clicking **Confirm Assignements**.

This Event should now trigger the flow we imported which will launch a certification campaing 

## Access Certification


The next capability we will explore is Access Certification. Access Certification (aka attestation, recertification etc.) is the mechanism to validate that a user still needs the access they have. It is a common control in compliance regulations. Certification campaigns may be run periodically, or there may be continuous certification when user roles change. Okta Identity Governance currently supports user-group memberships and user-application assignments. Participants in a campaign (such as the users manager) will approve (access retained) or revoke access (access should be removed).

This section of the document will explore the Access Certification mechanism in Okta Identity Governance by creating a campaign, launching it, and having a manager review access.

### Reviewing an Access Certification Campaign

Access certification is built into the Okta platform. There is an administrative interface to create and manage campaigns, and an end-user interface for participating in campaigns.

We will review the created campaign for users that was triggered by the **Title change**. 

#### Review the created campaign

To create a new campaign:

1. Login into Okta as an administrator and go to the Admin console
2. Find the new Identity Governance menu item and expand it
3. Click on Access Certifications

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img23.png "image_tooltip")

4. On this page we can see the campaign's most important details. however reviewing is done from the **Access certification Review** application

5. Log in to your **End User Dashboard** by clicking on the **Drop down menu** in the top right corner and click on **My End User Dashboard**

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img24.png "image_tooltip")

6. In the search bar entre **Okta Access Certification Reviews** and click on the results. 

![alt_text](https://raw.githubusercontent.com/keithledgerwood/WICLab-guide/main/images/007/img25.png "image_tooltip")

**New Content - END**
-----


## Access Certification

The next capability we will explore is Access Certification. Access Certification (aka attestation, recertification etc.) is the mechanism to validate that a user still needs the access they have. It is a common control in compliance regulations. Certification campaigns may be run periodically, or there may be continuous certification when user roles change. Okta Identity Governance currently supports user-group memberships and user-application assignments. Participants in a campaign (such as the users manager) will approve (access retained) or revoke access (access should be removed).

This section of the document will explore the Access Certification mechanism in Okta Identity Governance by creating a campaign, launching it, and having a manager review access.

### Creating an Access Certification Campaign

Access certification is built into the Okta platform. There is an administrative interface to create and manage campaigns, and an end-user interface for participating in campaigns.

We will create a campaign for resources in your environment. The example below will review the Distribution List (Okta Group) assignment, where the Distribution List is the one that was used in the Access Request section earlier. You can use any Distribution List in your environment but recall that the users should have valid managers and DL owners.

#### Create a new campaign

To create a new campaign:

1. Login into Okta as an administrator and go to the Admin console
2. Find the new Identity Governance menu item and expand it
3. Click on Access Certifications

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image15.png "image_tooltip")

4. Click Create Campaign to start the wizard

The wizard will walk through five pages of settings to configure the campaign, the first being the General page.

5. On the General page of the wizard, give the campaign a name, a description (optional) and specify a start date(put the date a few days in the future) and make it a recurring review

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image20.png "image_tooltip")

The campaign creation progress is shown on the left and the right pane will build up a summary of the campaign as you progress through the wizard.

6. Click Next Button

The Resources page is where you decide what you are certifying – group membership or application assignment. You can only select one type or another, but you can select multiple of each.

7. Select Type of Groups
8. Select the risky DLs of your environment, you can see them in the table below

<table class="c24"><tbody><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">DL_PROJECT_ERP</span></p></td></tr><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">DL_PROJECT_ERP_SAP</span></p></td></tr><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">DL_PROJECT_ERP_JDE</span></p></td></tr><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">DL_PROJECT_CRM</span></p></td></tr><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">DL_PROJECT_CRM_SLAESFORCE</span></p></td></tr></tbody></table>

10. The Resources section should look like the screenshot below

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image45.png "image_tooltip")

11. Click Next

On the Users page, you specify the scope of the users in the campaign. Are all users assigned to the group to be reviewed, or only some? Do you need to exclude specific users for some reason?

12. Leave the All users assigned to the resource option selected

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image21.png "image_tooltip")

13. Click Next

The reviewers are the Okta users who will review the access. There could be a single (static) reviewer specified as an Okta user. Or you can specify a dynamic reviewer, where the reviewer is based on some data in the Universal Directory (we will do this).

14. Select the First Level reviewer as the Manager
15. Set the fallback reviewer as you own admin account
16. Click on Add level to add a second reviewer level
17. Select the second reviewer as the Group Owner
18. Set the fallback reviewer as you own admin account
19. select the option Only approved decisions under the Additional Settings

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image29.png "image_tooltip")

20. Click Next

The remediation settings are the most important page – it’s the reason for the campaign. Every item (i.e. group membership or application assignment) has three options: approve, revoke and reassign.

If access is approved, the access is retained, and the decision is logged for audit purposes. If access is revoked, that’s indicating that the access should be removed. It can be flagged to be removed (i.e. don’t take any action) or removed. There may be implications on this depending on how the access was granted. Finally, a reviewer can reassign the review to someone else.

You also need to decide what is to occur if there are unreviewed items at the end of the campaign – should they be removed or left as is?

21. For the Reviewer revoke access option, select the Remove user from resource option
22. For the Reviewer does not respond option, select the Remove user from resource option

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image28.png "image_tooltip")

This is the last step in creating the campaign. You can go back and change things prior to scheduling.

23. Click the Schedule Campaign button to schedule it

The campaign will now appear under the Scheduled tab.

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image5.png "image_tooltip")

24. Click on the Campaign name to open it.

You will see a summary of the campaign.

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image26.png "image_tooltip")

<table class="c8"><tbody><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">This campaign will start on schedule. Analyzing campaign contents (users, review items, reviewers etc.) may be computationally expensive, so the default behavior is to launch it overnight. However, you can manually launch it, which we will do next.the flow or even run a custom Okta Workflow.</span></p></td></tr></tbody></table>

#### Launching an Access Certification Campaign

To launch the campaign immediately:

1. Click the Actions button from the campaign view
2. Select the Launch option
3. On the Launch campaign confirmation screen, click the Launch button

You will return to the Access certification campaigns page.

4. Go to the Active tab
5. If you don’t see your campaign, refresh the page

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image37.png "image_tooltip")

6. Click on the campaign name to see the campaign details

The page provides an overview of the campaign (the same information that was presented pre-launch), the progress of the campaign, and the items to be reviewed. Depending on the users (and their manager settings) assigned to the selected groups, you should see some managers with one or more users. You may also have users that don’t have managers assigned, so they have the fallback reviewer as the reviewer.

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image62.png "image_tooltip")

<table class="c8"><tbody><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">An administrator can use this page to manage the execution of a campaign. They can see the progress and any items still outstanding. They can reassign one or more items. They can also prematurely end the campaign (Actions &gt; End).</span></p></td></tr></tbody></table>

#### Participating in an Access Certification Campaign

##### Manager Review

Now that the campaign is running, we can switch to the role of reviewer to review some access. Select one of the reviewers (the manager as a first level) in your list above to perform the review.

1. Log into the Okta dashboard as that reviewer user
2. Look for the Okta Access Certification Reviews tile and click it

This tile (Okta application) is tied to a group where membership is dynamically managed within Okta. If an Okta user is flagged as a reviewer in any active campaign, they will be in the group and see the application on the dashboard.

You are presented with a list of campaigns the user is a reviewer for. You see a summary of information about each active campaign.

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image41.png "image_tooltip")

3. Click on the name of the campaign to open it

You will see all users for this group reporting to this manager.

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image1.png "image_tooltip")

For each item you have three options as a reviewer: Approve (leave the access as is), Revoke (remove access or flag for it to be removed) or Reassign (to another Okta user). Depending on screen resolution you will just see the icons or icons and words.

4. Click on the name of one of the users to see information about the user and access

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image3.png "image_tooltip")

This information is provided to help the reviewer in making their decision and currently includes user details and resource details, but there are plans to include fine-grained access information (if available) and review history.

5. Select one user and click the Approve (tick) button
6. When prompted, enter a Justification and click the Submit button

After each action, you will see a message displayed and the item will disappear from the view (they can be found under the Closed tab). When all are actioned, you will get confirmation that you are done with the reviews.

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image56.png "image_tooltip")

##### DL Owner Review

Now that the reviewer has completed the first step review, we will go back to our campaign as the administrator and refresh our Certification Campaign page and see its progress. You will notice that the next level of review goes to the DL Owner (Alex Meyer in our case)

1. If not still there, log into Okta and then the Admin console as the administrator you used earlier.
2. Go to Identity Governance > Access Certifications and select the campaign

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image60.png "image_tooltip")

1. Log into the Okta dashboard as that reviewer user (DL Owner : alex Meyer in our case)
2. Look for the Okta Access Certification Reviews tile and click it
3. Click on the name of the campaign to open it

You will see all users for this group owned by Alex Meyer.

4. Select one user and click the Revoke (X) button
5. When prompted, enter a Justification and click the Submit button

Now that the reviewer has completed their review, we will close out the campaign as the administrator.

#### Managing an Access Certification Campaign

As mentioned earlier, we can manage running campaigns as the administrator.

1. If not still there, log into Okta and then the Admin console as the administrator you used earlier.
2. Go to Identity Governance > Access Certifications and select the campaign

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image38.png "image_tooltip")

You can see the progress of the campaign after the reviewer has completed their review.

3.  Have a look at the campaign item

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image63.png "image_tooltip")

4. On the campaign view page, select Actions > End to end the campaign
5. Click End Campaign on the confirmation screen

We can check the revocation actions:

6. Go to the group and confirm that users (where the remediation was Successful) were removed

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image52.png "image_tooltip")

7. Check the DL is revoke in Google Workspace

1. Navigate to the Google Admin Console: [https://admin.google.com/](https://www.google.com/url?q=https://admin.google.com/&sa=D&source=editors&ust=1691582006641782&usg=AOvVaw0NARHSLlzC6lF20rUrjer_)
2. Go to Directory > User
3. Open your test user
4. and check that the user is removed from the Group or the DL

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image36.png "image_tooltip")

8. At the top of the group page, click the View Logs link
9. Look for your Distribution List entry for your revoked user

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image57.png "image_tooltip")

10. You will see two entries one for the revocation of the access in Okta side and the other for the revocation in Google Workspace via our native connector.

This shows the remediation has worked as expected.

## Audit and Reporting

The final capability we will explore is Reporting. The reporting engine in Okta has been rewritten to support the new governance reporting needs. New IGA reports are being added continuously.

The documentation to support this can be found [here](https://www.google.com/url?q=https://help.okta.com/oie/en-us/Content/Topics/identity-governance/iga-reports.htm&sa=D&source=editors&ust=1691582006645233&usg=AOvVaw1XHU6DjyLD-qA4f-28Bqre)

This section of the document will explore some of the IGA reports.

### Accessing Reports

Reporting is in the Okta Admin console:

1. Log into the Okta dashboard as an administrator and go to Admin 
2. Go to Reports > Reports

![alt_text](https://raw.githubusercontent.com/MarcoBlaesing/LabGuide/main/images/007/image54.png "image_tooltip")

Whilst there are existing reports that may be relevant to IGA, there are two new sets of reports: Entitlements and Access, and Access Certification Campaigns reports. We will explore these below.

<table class="c8"><tbody><tr class="c23"><td class="c12" colspan="1" rowspan="1"><p class="c10"><span class="c5">With the new reports there are two ways a report may be delivered – it may be generated and presented in real-time as has been the case to now, or it may be generated in the background with the requester getting an email with a link to review the report. This is set for individual reports – you cannot specify which delivery mechanism.</span></p></td></tr></tbody></table>

#### Entitlement and Access Reports

We will have a look at some of these reports.

1. From the Reports page select the User Memberships report
